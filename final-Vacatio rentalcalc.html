<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profit & Loss Estimator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .widget {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
        }
        h2 {
            text-align: center;
            margin-bottom: 10px;
            width: 100%;
            color: #333;
        }
        .subtitle {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            font-size: 0.9em;
            color: #666;
            line-height: 1.5;
        }
        .qr-code {
            position: absolute;
            top: 20px;
            right: 40px;
            text-align: center;
        }
        .qr-code img {
            width: 100px;
            height: 100px;
        }
        .qr-code-text {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        label {
            display: block;
            margin: 5px 0; /* Reduced margin to make inputs closer */
            font-weight: bold;
            color: #444;
        }
        input, select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .interest-rate-container, .occupancy-rate-container {
            position: relative;
        }
        .interest-rate-container::after, .occupancy-rate-container::after {
            content: '';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
        }
        button:hover {
            background-color: #218838;
        }
        .income-statement {
            margin-top: 20px;
            padding: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            width: 100%;
        }
        .income-statement h3 {
            margin-top: 0;
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f8f9fa;
            color: #333;
        }
        .bold-row {
            font-weight: bold; /* Added bold font for specific rows */
        }
     .input-columns {
    display: flex;
    flex-wrap: wrap;
    gap: 20px; 
    width: 100%;
    align-items: flex-start; /* Aligns inputs at the top */
}

.input-columns div {
    flex: 1; /* Makes both columns equal */
    min-width: 250px; /* Ensures responsiveness */
}

input, select {
    width: calc(100% - 16px); /* Adjusts for padding */
    box-sizing: border-box; /* Prevents width overflow */
}

label {
    display: block;
    margin-bottom: 5px; /* Ensures label is close to input */
}

        }
        .input-columns div {
            flex: 1;
        }
        .down-payment-display {
            font-size: 0.9em;
            color: #666;
            margin-top: -10px;
            margin-bottom: 10px;
        }
        .results-sidebar {
            width: 100%;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        .results-sidebar h3 {
            margin-top: 0;
            color: #333;
        }
        .bar-graph {
            width: 100%;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .bar-graph h3 {
            margin-top: 0;
            color: #333;
        }
        .vertical-bar-graph {
            display: flex;
            align-items: flex-end;
            gap: 10px;
            height: 200px;
        }
        .vertical-bar {
            width: 40px;
            background-color: #28a745;
            border-radius: 3px;
            position: relative;
        }
        .vertical-bar-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9em;
            color: #666;
        }
        .vertical-bar-value {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9em;
            color: #333;
        }
        .small-text {
            font-size: 0.8em;
            color: #666;
        }
        .positive {
            color: #228B22;
        }
        .negative {
            color: #8B0000;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 5px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .action-buttons button {
            width: auto;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .action-buttons button:hover {
            background-color: #0056b3;
        }
        @media print {
            .widget {
                box-shadow: none;
                border: 1px solid #ccc;
            }
            .bar-graph, .results-sidebar, .income-statement {
                page-break-inside: avoid;
            }
            .bold-row {
                font-weight: bold; /* Ensure bold rows are printed */
            }
        }
    </style>
</head>
<body>

<div class="widget">
    <h2>Profit & Loss Estimator for Maui Vacation Rental</h2>
    <div class="subtitle">
        Created by Travis Speck Real Estate<br>
        boundlessplaces@gmail.com<br>
        808 344 1917
    </div>
    <div class="qr-code">
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=https://www.mauitravis.com/" alt="QR Code">
        <div class="qr-code-text">mauitravis.com</div>
    </div>

    <!-- Input Fields -->
    <div class="input-columns">
        <div>
            <label for="purchasePrice">Purchase Price:</label>
            <input type="text" id="purchasePrice" placeholder="Enter purchase price" oninput="formatCurrency(this); updateDownPayment()">

            <label for="downPayment">Down Payment:</label>
            <select id="downPayment" onchange="updateDownPayment()">
                <option value="0">No Loan</option>
                <option value="0.25">25% Down</option>
                <option value="0.30">30% Down</option>
                <option value="0.40">40% Down</option>
                <option value="0.50">50% Down</option>
            </select>
            <div class="down-payment-display" id="downPaymentDisplay">Down Payment: $0.00 <span class="small-text">(30 yr fixed)</span></div>

            <label for="interestRate">Interest Rate %:</label>
            <div class="interest-rate-container">
                <input type="number" id="interestRate" placeholder="Enter interest rate" value="6.75" step="0.25">
            </div>

            <label for="nightlyRate">Average Nightly Rate:</label>
            <input type="text" id="nightlyRate" placeholder="Enter average nightly rate" oninput="formatCurrency(this)">

            <label for="occupancyRate">Occupancy Rate %:</label>
            <div class="occupancy-rate-container">
                <input type="number" id="occupancyRate" placeholder="Enter occupancy rate" value="85">
            </div>

            <label for="managementFee">Short-Term Management Fee:</label>
            <select id="managementFee">
                <option value="0">Self-Managed ($0 fee)</option>
                <option value="0.20">20%</option>
                <option value="0.25">25%</option>
                <option value="0.30">30%</option>
            </select>
        </div>
        <div>
            <label for="monthlyCondoFee">Monthly Condo Fee:</label>
            <input type="text" id="monthlyCondoFee" placeholder="Enter monthly condo fee" oninput="formatCurrency(this)">

            <label for="unitInsurance">Unit Insurance (Annual):</label>
            <div class="tooltip">
                <input type="text" id="unitInsurance" value="1,000" oninput="formatCurrency(this)">
                <span class="tooltiptext">HO6 policies vary. Condo fees often include condo master insurance policy.</span>
            </div>

            <label for="electricCost">Electric Cost (Monthly):</label>
            <input type="text" id="electricCost" placeholder="Enter electric cost" value="250" oninput="formatCurrency(this)">

            <label for="internet">Internet (Monthly):</label>
            <div class="tooltip">
                <input type="text" id="internet" placeholder="Enter internet cost" value="0" oninput="formatCurrency(this)">
                <span class="tooltiptext">AOAO fee commonly includes internet</span>
            </div>

            <label for="miscellaneous">Miscellaneous Expenses (Annual):</label>
            <input type="text" id="miscellaneous" placeholder="Enter miscellaneous expenses" oninput="formatCurrency(this)">
        </div>
    </div>

    <!-- Calculate Button -->
    <button onclick="calculate()">Calculate</button>

    <!-- Bar Graph -->
    <div class="bar-graph">
        <h3>Monthly Gross Income</h3>
        <div class="vertical-bar-graph" id="barGraph"></div>
    </div>

    <!-- Income Summary -->
    <div class="results-sidebar">
        <h3>Income Summary</h3>
        <p><strong>Net Income @ 70% Occupancy:</strong> <span id="netProfit70Sidebar">$0.00</span></p>
        <p><strong>Net Income @ 80% Occupancy:</strong> <span id="netProfit80Sidebar">$0.00</span></p>
        <p><strong>Net Income @ 90% Occupancy:</strong> <span id="netProfit90Sidebar">$0.00</span></p>
        <p><strong>Net Income @ <span id="occupancyRateDisplay">85%</span> Occupancy:</strong> <span id="netProfitCustomSidebar">$0.00</span></p>
        <p><strong>ROI:</strong> <span id="roi">0.00%</span></p>
	<p><strong>ROI Calculation:</strong> <span id="roiEquation"></span></p>
        <p><strong>Cash on Cash Return:</strong> <span id="cashOnCashReturn">0.00%</span></p>
	<p><strong>Cash on Cash Return Calculation:</strong> <span id="cashOnCashReturnEquation"></span></p>
    </div>

    <!-- Income Statement Table -->
    <div class="income-statement">
        <h3>Income Statement</h3>
        <table>
            <thead>
                <tr>
                    <th>Description</th>
                    <th>70% Occupancy</th>
                    <th>80% Occupancy</th>
                    <th>90% Occupancy</th>
                    <th><span id="occupancyRateHeader">85%</span> Occupancy</th>
                </tr>
            </thead>
            <tbody>
                <tr class="bold-row">
                    <td><strong>Gross Income</strong></td>
                    <td id="grossIncome70">0.00</td>
                    <td id="grossIncome80">0.00</td>
                    <td id="grossIncome90">0.00</td>
                    <td id="grossIncomeCustom">0.00</td>
                </tr>
                <tr>
                    <td>Short-Term Management Fee</td>
                    <td id="managementFeeDisplay70">0.00</td>
                    <td id="managementFeeDisplay80">0.00</td>
                    <td id="managementFeeDisplay90">0.00</td>
                    <td id="managementFeeDisplayCustom">0.00</td>
                </tr>
                <tr>
                    <td>Principal & Interest (Annual) <span class="small-text">(30 yr fixed)</span></td>
                    <td id="principalInterestAnnual70">0.00</td>
                    <td id="principalInterestAnnual80">0.00</td>
                    <td id="principalInterestAnnual90">0.00</td>
                    <td id="principalInterestAnnualCustom">0.00</td>
                </tr>
                <tr>
                    <td>Property Taxes (Annual)</td>
                    <td id="propertyTaxes70">0.00</td>
                    <td id="propertyTaxes80">0.00</td>
                    <td id="propertyTaxes90">0.00</td>
                    <td id="propertyTaxesCustom">0.00</td>
                </tr>
                <tr>
                    <td>Monthly Condo Fee (Annual)</td>
                    <td id="condoFeeAnnual70">0.00</td>
                    <td id="condoFeeAnnual80">0.00</td>
                    <td id="condoFeeAnnual90">0.00</td>
                    <td id="condoFeeAnnualCustom">0.00</td>
                </tr>
                <tr>
                    <td>Unit Insurance</td>
                    <td id="unitInsuranceAnnual70">0.00</td>
                    <td id="unitInsuranceAnnual80">0.00</td>
                    <td id="unitInsuranceAnnual90">0.00</td>
                    <td id="unitInsuranceAnnualCustom">0.00</td>
                </tr>
                <tr>
                    <td>Electric Cost (Annual)</td>
                    <td id="electricCostAnnual70">0.00</td>
                    <td id="electricCostAnnual80">0.00</td>
                    <td id="electricCostAnnual90">0.00</td>
                    <td id="electricCostAnnualCustom">0.00</td>
                </tr>
                <tr>
                    <td>Internet (Annual)</td>
                    <td id="internetAnnual70">0.00</td>
                    <td id="internetAnnual80">0.00</td>
                    <td id="internetAnnual90">0.00</td>
                    <td id="internetAnnualCustom">0.00</td>
                </tr>
                <tr>
                    <td>Miscellaneous Expenses</td>
                    <td id="miscellaneousAnnual70">0.00</td>
                    <td id="miscellaneousAnnual80">0.00</td>
                    <td id="miscellaneousAnnual90">0.00</td>
                    <td id="miscellaneousAnnualCustom">0.00</td>
                </tr>
                <tr class="bold-row">
                    <td><strong>Total Expenses</strong></td>
                    <td id="totalExpenses70">0.00</td>
                    <td id="totalExpenses80">0.00</td>
                    <td id="totalExpenses90">0.00</td>
                    <td id="totalExpensesCustom">0.00</td>
                </tr>
                <tr class="bold-row">
                    <td><strong>Est. Net Income</strong></td>
                    <td id="netProfit70">0.00</td>
                    <td id="netProfit80">0.00</td>
                    <td id="netProfit90">0.00</td>
                    <td id="netProfitCustom">0.00</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Action Buttons (Print) -->
    <div class="action-buttons">
        <button onclick="printIncomeStatement()">Print</button>
    </div>
</div>

<script>

function formatPercentage(input) {
    let value = input.value.replace(/[^0-9.]/g, ''); // Remove non-numeric characters except '.'
    if (value) {
        input.value = `${value}%`; // Append % to the number
    } else {
        input.value = ''; // Prevents showing just '%'
    }
}

    function formatCurrency(input) {
        let value = input.value.replace(/[^0-9.]/g, '');
        input.value = new Intl.NumberFormat('en-US').format(value);
    }

    function parseCurrency(value) {
        return parseFloat(value.replace(/,/g, '')) || 0;
    }

    function updateDownPayment() {
        const purchasePrice = parseCurrency(document.getElementById('purchasePrice').value);
        const downPaymentPercentage = parseFloat(document.getElementById('downPayment').value) || 0;
        const downPaymentAmount = purchasePrice * downPaymentPercentage;
        document.getElementById('downPaymentDisplay').innerHTML = `Down Payment: $${new Intl.NumberFormat('en-US').format(downPaymentAmount.toFixed(2))} <span class="small-text">(30 yr fixed)</span>`;
    }

    function calculatePropertyTaxes(purchasePrice) {
        if (purchasePrice <= 1000000) {
            return (purchasePrice / 1000) * 12.50;
        } else if (purchasePrice <= 3000000) {
            return (1000000 / 1000) * 12.50 + ((purchasePrice - 1000000) / 1000) * 13.50;
        } else {
            return (1000000 / 1000) * 12.50 + (2000000 / 1000) * 13.50 + ((purchasePrice - 3000000) / 1000) * 15.00;
        }
    }

    function calculate() {
        // Get input values
        const purchasePrice = parseCurrency(document.getElementById('purchasePrice').value);
        const downPaymentPercentage = parseFloat(document.getElementById('downPayment').value) || 0;
        const interestRate = parseFloat(document.getElementById('interestRate').value) || 6.75; // Default to 6.75%
        const nightlyRate = parseCurrency(document.getElementById('nightlyRate').value);
        const occupancyRate = parseFloat(document.getElementById('occupancyRate').value) || 85; // Prefilled to 85%
        const monthlyCondoFee = parseCurrency(document.getElementById('monthlyCondoFee').value);
        const unitInsurance = parseCurrency(document.getElementById('unitInsurance').value);
        const electricCost = parseCurrency(document.getElementById('electricCost').value);
        const internet = parseCurrency(document.getElementById('internet').value);
        const miscellaneous = parseCurrency(document.getElementById('miscellaneous').value);
        const managementFee = parseFloat(document.getElementById('managementFee').value) || 0;

        // Update occupancy rate display
        document.getElementById('occupancyRateDisplay').textContent = `${occupancyRate}%`;
        document.getElementById('occupancyRateHeader').textContent = `${occupancyRate}%`;

        // Calculate loan amount
        const downPaymentAmount = purchasePrice * downPaymentPercentage;
        const loanAmount = purchasePrice - downPaymentAmount;

        // Calculate monthly mortgage payment (if loan exists)
        let monthlyPayment = 0;
        if (loanAmount > 0 && downPaymentPercentage !== 0) {
            const monthlyInterestRate = (interestRate / 100) / 12;
            const loanTermMonths = 30 * 12; // 30-year loan term
            monthlyPayment = (loanAmount * monthlyInterestRate) / (1 - Math.pow(1 + monthlyInterestRate, -loanTermMonths));
        }

        // Calculate annual gross income for 80%, 70%, 90%, and custom occupancy
        const daysInYear = 365;
        const grossIncome80 = nightlyRate * daysInYear * (80 / 100);
        const grossIncome70 = nightlyRate * daysInYear * (70 / 100);
        const grossIncome90 = nightlyRate * daysInYear * (90 / 100);
        const grossIncomeCustom = nightlyRate * daysInYear * (occupancyRate / 100);

        // Calculate annual expenses
        const managementFeeAmount80 = grossIncome80 * managementFee;
        const managementFeeAmount70 = grossIncome70 * managementFee;
        const managementFeeAmount90 = grossIncome90 * managementFee;
        const managementFeeAmountCustom = grossIncomeCustom * managementFee;

        const principalInterestAnnual = monthlyPayment * 12;
        const condoFeeAnnual = monthlyCondoFee * 12;
        const propertyTaxes = calculatePropertyTaxes(purchasePrice); // Updated property taxes formula
        const electricCostAnnual = electricCost * 12;
        const internetAnnual = internet * 12;

        // Total expenses for 80%, 70%, 90%, and custom occupancy
        const totalExpenses80 = managementFeeAmount80 + principalInterestAnnual + condoFeeAnnual + propertyTaxes + unitInsurance + electricCostAnnual + internetAnnual + miscellaneous;
        const totalExpenses70 = managementFeeAmount70 + principalInterestAnnual + condoFeeAnnual + propertyTaxes + unitInsurance + electricCostAnnual + internetAnnual + miscellaneous;
        const totalExpenses90 = managementFeeAmount90 + principalInterestAnnual + condoFeeAnnual + propertyTaxes + unitInsurance + electricCostAnnual + internetAnnual + miscellaneous;
        const totalExpensesCustom = managementFeeAmountCustom + principalInterestAnnual + condoFeeAnnual + propertyTaxes + unitInsurance + electricCostAnnual + internetAnnual + miscellaneous;

        // Net profit for 80%, 70%, 90%, and custom occupancy
        const netProfit80 = grossIncome80 - totalExpenses80;
        const netProfit70 = grossIncome70 - totalExpenses70;
        const netProfit90 = grossIncome90 - totalExpenses90;
        const netProfitCustom = grossIncomeCustom - totalExpensesCustom;

        // Calculate ROI and Cash on Cash Return
        const roi = (netProfitCustom / purchasePrice) * 100;
        const cashOnCashReturn = (netProfitCustom / downPaymentAmount) * 100;

        // Display ROI and Cash on Cash Return
        document.getElementById('roi').textContent = `${roi.toFixed(2)}%`;
	document.getElementById('roiEquation').textContent = `(${netProfitCustom.toFixed(2)} ÷ ${purchasePrice.toFixed(2)}) × 100 = ${roi.toFixed(2)}%`;
        document.getElementById('cashOnCashReturn').textContent = `${cashOnCashReturn.toFixed(2)}%`;
	const cashOnCashReturnEquation = `($${netProfitCustom.toFixed(2)} ÷ $${downPaymentAmount.toFixed(2)}) × 100 = 	${cashOnCashReturn.toFixed(2)}%`;
	document.getElementById('cashOnCashReturnEquation').textContent = cashOnCashReturnEquation;
        // Display results for 80% occupancy
        document.getElementById('grossIncome80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(grossIncome80.toFixed(2));
        document.getElementById('managementFeeDisplay80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(managementFeeAmount80.toFixed(2));
        document.getElementById('principalInterestAnnual80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(principalInterestAnnual.toFixed(2));
        document.getElementById('propertyTaxes80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(propertyTaxes.toFixed(2));
        document.getElementById('condoFeeAnnual80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(condoFeeAnnual.toFixed(2));
        document.getElementById('unitInsuranceAnnual80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(unitInsurance.toFixed(2));
        document.getElementById('electricCostAnnual80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(electricCostAnnual.toFixed(2));
        document.getElementById('internetAnnual80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(internetAnnual.toFixed(2));
        document.getElementById('miscellaneousAnnual80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(miscellaneous.toFixed(2));
        document.getElementById('totalExpenses80').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(totalExpenses80.toFixed(2));
        document.getElementById('netProfit80').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfit80);
        document.getElementById('netProfit80').className = netProfit80 >= 0 ? 'positive' : 'negative';

        // Display results for 70% occupancy
        document.getElementById('grossIncome70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(grossIncome70.toFixed(2));
        document.getElementById('managementFeeDisplay70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(managementFeeAmount70.toFixed(2));
        document.getElementById('principalInterestAnnual70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(principalInterestAnnual.toFixed(2));
        document.getElementById('propertyTaxes70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(propertyTaxes.toFixed(2));
        document.getElementById('condoFeeAnnual70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(condoFeeAnnual.toFixed(2));
        document.getElementById('unitInsuranceAnnual70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(unitInsurance.toFixed(2));
        document.getElementById('electricCostAnnual70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(electricCostAnnual.toFixed(2));
        document.getElementById('internetAnnual70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(internetAnnual.toFixed(2));
        document.getElementById('miscellaneousAnnual70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(miscellaneous.toFixed(2));
        document.getElementById('totalExpenses70').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(totalExpenses70.toFixed(2));
        document.getElementById('netProfit70').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfit70);
        document.getElementById('netProfit70').className = netProfit70 >= 0 ? 'positive' : 'negative';

        // Display results for 90% occupancy
        document.getElementById('grossIncome90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(grossIncome90.toFixed(2));
        document.getElementById('managementFeeDisplay90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(managementFeeAmount90.toFixed(2));
        document.getElementById('principalInterestAnnual90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(principalInterestAnnual.toFixed(2));
        document.getElementById('propertyTaxes90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(propertyTaxes.toFixed(2));
        document.getElementById('condoFeeAnnual90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(condoFeeAnnual.toFixed(2));
        document.getElementById('unitInsuranceAnnual90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(unitInsurance.toFixed(2));
        document.getElementById('electricCostAnnual90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(electricCostAnnual.toFixed(2));
        document.getElementById('internetAnnual90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(internetAnnual.toFixed(2));
        document.getElementById('miscellaneousAnnual90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(miscellaneous.toFixed(2));
        document.getElementById('totalExpenses90').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(totalExpenses90.toFixed(2));
        document.getElementById('netProfit90').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfit90);
        document.getElementById('netProfit90').className = netProfit90 >= 0 ? 'positive' : 'negative';

        // Display results for custom occupancy
        document.getElementById('grossIncomeCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(grossIncomeCustom.toFixed(2));
        document.getElementById('managementFeeDisplayCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(managementFeeAmountCustom.toFixed(2));
        document.getElementById('principalInterestAnnualCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(principalInterestAnnual.toFixed(2));
        document.getElementById('propertyTaxesCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(propertyTaxes.toFixed(2));
        document.getElementById('condoFeeAnnualCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(condoFeeAnnual.toFixed(2));
        document.getElementById('unitInsuranceAnnualCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(unitInsurance.toFixed(2));
        document.getElementById('electricCostAnnualCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(electricCostAnnual.toFixed(2));
        document.getElementById('internetAnnualCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(internetAnnual.toFixed(2));
        document.getElementById('miscellaneousAnnualCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(miscellaneous.toFixed(2));
        document.getElementById('totalExpensesCustom').textContent = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(totalExpensesCustom.toFixed(2));
        document.getElementById('netProfitCustom').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfitCustom);
        document.getElementById('netProfitCustom').className = netProfitCustom >= 0 ? 'positive' : 'negative';

        // Update sidebar results
        document.getElementById('netProfit70Sidebar').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfit70);
        document.getElementById('netProfit70Sidebar').className = netProfit70 >= 0 ? 'positive' : 'negative';
        document.getElementById('netProfit80Sidebar').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfit80);
        document.getElementById('netProfit80Sidebar').className = netProfit80 >= 0 ? 'positive' : 'negative';
        document.getElementById('netProfit90Sidebar').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfit90);
        document.getElementById('netProfit90Sidebar').className = netProfit90 >= 0 ? 'positive' : 'negative';
        document.getElementById('netProfitCustomSidebar').textContent = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(netProfitCustom);
        document.getElementById('netProfitCustomSidebar').className = netProfitCustom >= 0 ? 'positive' : 'negative';

        // Generate vertical bar graph for monthly gross income
        const monthlyPercentages = [9.72, 9.36, 8.64, 7.75, 8.07, 7.45, 7.15, 6.56, 6.28, 7.13, 10.25, 11.63];
        const barGraph = document.getElementById('barGraph');
        barGraph.innerHTML = '';
        const maxIncome = Math.max(...monthlyPercentages.map(p => grossIncome80 * (p / 100)));
        monthlyPercentages.forEach((percentage, index) => {
            const monthIncome = Math.round(grossIncome80 * (percentage / 100)); // Round to nearest dollar
            const bar = document.createElement('div');
            bar.className = 'vertical-bar';
            bar.style.height = `${(monthIncome / maxIncome) * 100}%`;
            bar.innerHTML = `
                <div class="vertical-bar-value">$${new Intl.NumberFormat('en-US').format(monthIncome)}</div>
                <div class="vertical-bar-label">${new Date(2023, index).toLocaleString('default', { month: 'short' })}</div>
            `;
            barGraph.appendChild(bar);
        });
    }

    // Print the income statement
    function printIncomeStatement() {
        window.print();
    }
</script>

</body>
</html>